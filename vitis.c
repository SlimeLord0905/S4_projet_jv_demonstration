#include "scaler.h"
#include "vdma.h"
#include "sleep.h"
#include "controler.h"

#define SIZE_X 80
#define SIZE_Y 45

const int initialBackground[SIZE_Y][SIZE_X] = {
        {4, 4, 4, 6, 6, 6, 6, 4, 4, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 4, 4},
        {4, 4, 5, 4, 4, 5, 4, 4, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5},
        {4, 4, 4, 4, 4, 7, 6, 7, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 7, 7, 6, 7, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 5, 6, 7, 7, 6, 7, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 5, 4, 5, 4, 4, 5, 5, 4},
        {4, 4, 5, 6, 7, 6, 6, 7, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 7, 6, 7, 5, 4, 4, 4, 5},
        {4, 4, 4, 6, 7, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 7, 6, 7, 7, 6, 4, 4, 4},
        {5, 5, 4, 6, 7, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 7, 6, 6, 7, 6, 5, 4, 4},
        {5, 5, 5, 6, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 7, 6, 6, 7, 6, 5, 5, 4},
        {4, 5, 4, 6, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 7, 6, 6, 6, 6, 4, 4, 5},
        {4, 5, 5, 6, 6, 6, 6, 6, 6, 4, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 6, 5, 5, 4, 4, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {5, 5, 4, 4, 5, 5, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 4, 4},
        {4, 4, 5, 4, 4, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 5, 6, 6, 6, 6, 6, 6, 5, 5, 4},
        {4, 4, 4, 5, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 5, 5, 6, 6, 6, 6, 6, 4, 4, 5},
        {4, 4, 4, 7, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 7, 4, 4, 5, 5, 6, 6, 4, 4, 4},
        {4, 5, 5, 7, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 7, 6, 6, 7, 4, 4, 5, 4, 4, 4},
        {4, 4, 4, 7, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 7, 6, 6, 7, 6, 5, 4, 4, 4, 4},
        {4, 4, 4, 7, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 7, 6, 6, 7, 6, 6, 5, 4, 4, 5},
        {5, 5, 4, 4, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 7, 6, 6, 7, 6, 6, 6, 4, 4, 5},
        {4, 5, 5, 5, 5, 5, 5, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 4, 4, 5},
        {5, 5, 4, 7, 7, 7, 5, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 4, 4, 4},
        {4, 5, 5, 7, 7, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 7, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 7, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4},
        {5, 4, 4, 6, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 6, 6, 4, 5, 5, 5, 4, 4},
        {4, 5, 4, 6, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 5, 5, 5, 4, 4, 4, 5, 4, 4},
        {4, 5, 5, 6, 6, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 7, 6, 6, 4, 5, 4},
        {4, 4, 4, 4, 4, 6, 6, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 7, 6, 6, 4, 4, 5},
        {4, 4, 4, 4, 4, 5, 5, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 7, 6, 6, 4, 4, 4},
        {4, 4, 5, 6, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 5, 6, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 5, 4, 6, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 5, 5, 4},
        {5, 5, 4, 6, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 4, 5},
        {4, 4, 4, 6, 6, 6, 7, 6, 6, 8, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 4, 4, 4},
        {4, 4, 4, 6, 6, 6, 6, 6, 8, 8, 8, 8, 14, 12, 13, 8, 8, 6, 6, 6, 6, 6, 6, 11, 10, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 8, 6, 6, 11, 10, 6, 6, 6, 6, 14, 12, 13, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 14, 12, 13, 8, 8, 8, 8, 11, 10, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, 4, 4},
        {5, 4, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 14, 12, 13, 8, 8, 8, 8, 8, 8, 8, 8, 11, 10, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 8, 6, 8, 11, 10, 8, 8, 8, 8, 14, 12, 13, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 14, 12, 13, 8, 8, 8, 8, 11, 10, 8, 8, 8, 8, 8, 9, 9, 8, 8, 8, 4, 4, 4},
        {5, 5, 4, 4, 8, 8, 8, 8, 8, 8, 8, 8, 14, 12, 13, 8, 8, 8, 8, 8, 8, 8, 8, 11, 10, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 11, 10, 8, 8, 8, 8, 14, 12, 13, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 14, 12, 13, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 4, 4, 4},
        {4, 4, 5, 5, 4, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 14, 12, 13, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 14, 12, 13, 9, 9, 9, 9, 9, 9, 9, 9, 9, 12, 12, 12, 12, 9, 9, 9, 5, 5, 4},
        {4, 4, 4, 5, 5, 5, 5, 5, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 12, 12, 12, 12, 12, 9, 9, 9, 9, 9, 9, 12, 12, 12, 12, 12, 12, 12, 12, 4, 4, 5, 5},
        {4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 4, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 4, 5, 5, 5, 5, 5},
        {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
        {2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
        {3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
    };



void genBackground(int offsetY) {
	offsetY = ((offsetY - 8) % 1024 + 1024) % 1024;
	int y = offsetY/8;
	if (offsetY % 8 == 0)
	{
		for (int x = 0; x < SIZE_X; x++)
		{
			ChangeBackGroundBuffer(initialBackground[y % 36][x], y, x);
		}
	}
}

void drawPlatform(int row, int column, int width) {
    for (int i = 0; i < width; i++) {
        ChangeBackGroundBuffer(1, row, column + i);     // rangée supérieure (tuile ID 1)
        ChangeBackGroundBuffer(2, row + 1, column + i); // rangée inférieure (tuile ID 2)
    }
}

void drawAllPlatforms() {
    drawPlatform(35, 34, 7);  // row, column, largeur
    drawPlatform(30, 44, 6);
    drawPlatform(23, 52, 9);
    drawPlatform(15, 44, 7);
    drawPlatform(9, 56, 6);
    drawPlatform(5, 44, 8);
    drawPlatform(27, 12, 7);
    drawPlatform(21, 25, 9);
    drawPlatform(11, 16, 4);
    drawPlatform(6, 29, 5);
}

void loadBackground() {
    for (int y = 0; y < SIZE_Y + 40; y++)
    {

			for (size_t x = 0; x < SIZE_X; x++)
			{
				ChangeBackGroundBuffer(initialBackground[y][x] , y, x);
			}

    }
}

void land() {
    for (int i = 0; i < 10; i++)
            {
                if (i<5)
                {
                    ChangeActorTile(0, 2);
                }
                if (i<10 && i>5)
                {
                    ChangeActorTile(0, 1);
                }
            }
    usleep(50000);
}

void windup() {
    for (int i = 0; i < 5; i++)
    {
        ChangeActorTile(0, 2);
    }
    usleep(50000);
}

int main()
{
	configureScaler();
    configureVdma();

    loadBackground();
    drawAllPlatforms();

    ChangeActorTile(0, 1);
    ChangeActorPos(0, 328, 320);

    int i = 0;
    int offset = 0;
    int clock = 0;

    int sleep = 25000;
    while (1)
        {
    	int posX = 328;
		int posY = 320;
    	//first walk droite
    	            for (int i = 0; i < 16; i++)
    	            {
    	                posX++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            windup();
    	            ChangeActorTile(0, 3);
    	            //first jump
    	            for (int i = 0; i < 72  ; i++)
    	            {
    	                if (i % 3 == 0)
    	                    posX--;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (int i = 0; i < 16  ; i++)
    	            {
    	                if (i % 2 == 0)
    	                    posX--;
    	                posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            land();
    	            windup();

    	            //2nd jump
    	            ChangeActorTile(0, 3);
    	            for (size_t i = 0; i < 60; i++)
    	            {
    	                if (i % 3 == 0)
    	                posX++;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (size_t i = 0; i < 20; i++)
    	            {
    	                posX++;
    	                posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            land();
    	            //step gauche
    	            for (int i = 0; i < 32; i++)
    	            {
    	                posX++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            windup();

    	            //3rd jump
    	            ChangeActorTile(0, 3);
    	            for (int i = 0; i < 72  ; i++)
    	            {
    	                if (i % 3 == 0)
    	                    posX++;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (int i = 0; i < 16  ; i++)
    	            {
    	                if (i % 2 == 0)
    	                    posX++;
    	                posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            land();
    	            windup();
    	            //4th jump
    	            ChangeActorTile(0, 3);
    	            for (int i = 0; i < 80  ; i++)
    	            {
    	                if (i % 5 == 0)
    	                    posX--;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (int i = 0; i < 16  ; i++)
    	            {
    	                if (i % 2 == 0)
    	                    posX--;
    	                posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            land();
    	            windup();

    	            //5th jump
    	            ChangeActorTile(0, 3);
    	            for (int i = 0; i < 64; i++)
    	            {
    	                if (i % 2 == 0)
    	                    posX++;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (int i = 0; i < 32  ; i++)
    	            {
    	                posX++;
    	                if (i % 2)
    	                    posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            land();
    	            windup();

    	            //6th jump
    	            ChangeActorTile(0, 3);
    	            for (int i = 0; i < 48; i++)
    	            {
						posX--;
    	                posY--;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }
    	            for (int i = 0; i < 16  ; i++)
    	            {
    	                posX--;
    	                posY++;
    	                ChangeActorPos(0, posX, posY);
    	                usleep(sleep);
    	            }

    	            //walk off
    	            for (int i = 0; i < 56; i++)
					{
						posX--;
						ChangeActorPos(0, posX, posY);
						usleep(sleep);
					}
    	            land();

    	            //fall
    	            ChangeActorTile(0, 3);
    	            for (int i = 0; i < 296; i++)
					{
						posY++;
						ChangeActorPos(0, posX, posY);
						usleep(sleep);
					}
    	            land();
        }


    return 0;
}


